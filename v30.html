<!DOCTYPE html>
<html lang="sk">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Prevodn√≠k jednotiek</title>
<style>
:root {
  --bg-start: #0a1929;
  --bg-end: #1a237e;
  --surface: rgba(30, 41, 59, 0.9);
  --surface-hover: rgba(45, 56, 79, 0.95);
  --accent: #3b82f6;
  --accent-hover: #2563eb;
  --accent-glow: rgba(59, 130, 246, 0.4);
  --text: #f1f5f9;
  --text-secondary: #94a3b8;
  --border: rgba(255, 255, 255, 0.1);
  --radius: 20px;
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
  --shadow-hover: 0 25px 60px rgba(0, 0, 0, 0.6);
}

.theme-light {
  --bg-start: #e0f2fe;
  --bg-end: #bfdbfe;
  --surface: rgba(255, 255, 255, 0.95);
  --surface-hover: rgba(248, 250, 252, 1);
  --text: #1e293b;
  --text-secondary: #64748b;
  --border: rgba(0, 0, 0, 0.08);
  --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
  --shadow-hover: 0 15px 40px rgba(0, 0, 0, 0.15);
  --accent-glow: rgba(59, 130, 246, 0.2);
}

.theme-purple {
  --accent: #a855f7;
  --accent-hover: #9333ea;
  --accent-glow: rgba(168, 85, 247, 0.4);
}

.theme-green {
  --accent: #10b981;
  --accent-hover: #059669;
  --accent-glow: rgba(16, 185, 129, 0.4);
}

.theme-orange {
  --accent: #f59e0b;
  --accent-hover: #d97706;
  --accent-glow: rgba(245, 158, 11, 0.4);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: "Inter", "Roboto", system-ui, -apple-system, sans-serif;
  background: linear-gradient(135deg, var(--bg-start), var(--bg-end));
  color: var(--text);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 20px;
  transition: var(--transition);
  position: relative;
  overflow-x: hidden;
}

body::before {
  content: "";
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle at center, var(--accent-glow) 0%, transparent 70%);
  animation: bgRotate 30s linear infinite;
  pointer-events: none;
  z-index: 0;
}

@keyframes bgRotate {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

.app {
  width: 100%;
  max-width: 560px;
  max-height: 90vh;
  background: var(--surface);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid var(--border);
  overflow: hidden;
  animation: fadeInScale 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  position: relative;
  z-index: 1;
  display: flex;
  flex-direction: column;
}

@keyframes fadeInScale {
  from { 
    opacity: 0; 
    transform: translateY(30px) scale(0.95); 
  }
  to { 
    opacity: 1; 
    transform: translateY(0) scale(1); 
  }
}

/* Menu */
#menu {
  display: flex;
  flex-direction: column;
  padding: 32px 24px;
  gap: 8px;
  overflow-y: auto;
  flex: 1;
}

#menu::-webkit-scrollbar {
  width: 8px;
}

#menu::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 10px;
}

#menu::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: 10px;
}

.menu-header {
  text-align: center;
  margin-bottom: 24px;
  padding-bottom: 24px;
  border-bottom: 1px solid var(--border);
}

.menu-title {
  font-size: 2rem;
  font-weight: 800;
  margin-bottom: 8px;
  background: linear-gradient(135deg, var(--accent), var(--accent-hover));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: -0.02em;
}

.menu-subtitle {
  font-size: 0.95rem;
  color: var(--text-secondary);
  line-height: 1.5;
}

.menu-category {
  font-size: 0.85rem;
  font-weight: 700;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 1px;
  margin: 16px 0 8px 8px;
}

.menu-btn {
  background: var(--surface-hover);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 16px 20px;
  font-size: 1.05rem;
  font-weight: 500;
  cursor: pointer;
  text-align: left;
  transition: var(--transition);
  display: flex;
  align-items: center;
  gap: 12px;
}

.menu-btn:hover {
  background: var(--accent);
  color: white;
  transform: translateX(4px);
  box-shadow: 0 8px 20px var(--accent-glow);
  border-color: transparent;
}

.menu-btn:active { 
  transform: translateX(4px) scale(0.98); 
}

/* Sections */
.section {
  display: none !important;
  padding: 28px 24px;
  animation: slideIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
  overflow-y: auto;
  flex: 1;
}

.section::-webkit-scrollbar {
  width: 8px;
}

.section::-webkit-scrollbar-track {
  background: rgba(0, 0, 0, 0.2);
  border-radius: 10px;
}

.section::-webkit-scrollbar-thumb {
  background: var(--accent);
  border-radius: 10px;
}

@keyframes slideIn {
  from { 
    opacity: 0; 
    transform: translateX(20px); 
  }
  to { 
    opacity: 1; 
    transform: translateX(0); 
  }
}

.section.active { 
  display: block !important; 
}

.back-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 24px;
  padding-bottom: 16px;
  border-bottom: 1px solid var(--border);
}

.back-btn {
  color: var(--accent);
  cursor: pointer;
  font-weight: 600;
  text-decoration: none;
  transition: var(--transition);
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  border-radius: 8px;
}

.back-btn:hover {
  background: var(--accent);
  color: white;
  transform: translateX(-2px);
}

.section-title {
  font-size: 1.3rem;
  font-weight: 700;
  color: var(--text);
}

/* Calculator */
.calculator {
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.calc-display {
  width: 100%;
  background: #000;
  color: #00e5ff;
  font-size: 2.2rem;
  font-weight: 600;
  text-align: right;
  border: none;
  padding: 24px;
  border-radius: var(--radius);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.5);
  font-family: "Courier New", monospace;
  letter-spacing: 1px;
}

.calc-display::placeholder {
  color: rgba(0, 229, 255, 0.3);
}

.calc-grid {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
}

.calc-grid button {
  padding: 22px;
  font-size: 1.2rem;
  font-weight: 600;
  background: var(--surface-hover);
  border: 1px solid var(--border);
  border-radius: 14px;
  color: var(--text);
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.calc-grid button:hover { 
  background: rgba(255, 255, 255, 0.1);
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.calc-grid button:active { 
  transform: scale(0.95); 
}

.calc-grid .accent { 
  background: linear-gradient(135deg, var(--accent), var(--accent-hover));
  color: white;
  border: none;
  box-shadow: 0 4px 16px var(--accent-glow);
}

.calc-grid .accent:hover {
  box-shadow: 0 6px 20px var(--accent-glow);
  transform: translateY(-2px) scale(1.02);
}

/* Converter */
.converter {
  background: var(--surface-hover);
  border-radius: var(--radius);
  padding: 24px;
  border: 1px solid var(--border);
  display: grid;
  gap: 16px;
}

.converter label {
  font-size: 0.9rem;
  font-weight: 600;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.5px;
  margin-bottom: -8px;
}

.converter select,
.converter input {
  width: 100%;
  background: rgba(0, 0, 0, 0.2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 14px 16px;
  font-size: 1.05rem;
  transition: var(--transition);
  font-weight: 500;
}

.converter input:focus,
.converter select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 3px var(--accent-glow);
}

.converter button {
  width: 100%;
  background: linear-gradient(135deg, var(--accent), var(--accent-hover));
  color: white;
  border: none;
  border-radius: 12px;
  padding: 16px;
  font-size: 1.1rem;
  font-weight: 700;
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 4px 16px var(--accent-glow);
  margin-top: 8px;
}

.converter button:hover { 
  transform: translateY(-2px);
  box-shadow: 0 6px 24px var(--accent-glow);
}

.converter button:active {
  transform: scale(0.98);
}

.result {
  margin-top: 8px;
  text-align: center;
  font-weight: 700;
  font-size: 1.3rem;
  color: var(--accent);
  min-height: 2em;
  padding: 16px;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 12px;
  border: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: center;
}

.small {
  font-size: 0.85rem;
  color: var(--text-secondary);
  line-height: 1.5;
}

/* Settings */
.settings {
  display: grid;
  gap: 20px;
}

.settings .card {
  background: var(--surface-hover);
  border-radius: 16px;
  padding: 24px;
  border: 1px solid var(--border);
  transition: var(--transition);
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.settings .card:hover {
  border-color: var(--accent);
  box-shadow: 0 4px 16px var(--accent-glow);
}

.settings label {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
  font-weight: 500;
  font-size: 1.05rem;
}

.settings input[type="checkbox"],
.settings input[type="radio"] {
  width: 20px;
  height: 20px;
  cursor: pointer;
  accent-color: var(--accent);
}

.settings select {
  width: 100%;
  background: rgba(0, 0, 0, 0.2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px;
  font-size: 1rem;
  cursor: pointer;
}

.settings .btn {
  width: 100%;
  background: var(--surface-hover);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 14px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: var(--transition);
}

.settings .btn:hover { 
  background: var(--accent);
  color: white;
  border-color: transparent;
  box-shadow: 0 4px 16px var(--accent-glow);
}

.settings .btn:active {
  transform: scale(0.98);
}

.theme-selector {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 14px;
}

.theme-option {
  padding: 14px;
  border-radius: 10px;
  border: 2px solid var(--border);
  cursor: pointer;
  text-align: center;
  font-weight: 600;
  transition: var(--transition);
  background: rgba(0, 0, 0, 0.2);
}

.theme-option:hover {
  transform: scale(1.05);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.theme-option.active {
  border-color: var(--accent);
  background: var(--accent);
  color: white;
}

.theme-blue { border-color: #3b82f6; }
.theme-purple { border-color: #a855f7; }
.theme-green { border-color: #10b981; }
.theme-orange { border-color: #f59e0b; }

@media (max-width: 480px) {
  .menu-title { font-size: 1.6rem; }
  .calc-display { font-size: 1.8rem; }
  .calc-grid button { padding: 18px; font-size: 1.1rem; }
}
</style>
</head>
<body>
<div class="app" role="application" aria-label="Prevodn√≠k jednotiek">
  <div id="menu" aria-label="Hlavn√© menu">
    <div class="menu-header">
      <div class="menu-title">Prevodn√≠k jednotiek</div>
    </div>

    <div class="menu-category">üßÆ N√°stroje</div>
    <button class="menu-btn" onclick="openSection('calc')"><span>üßÆ</span> Kalkulaƒçka</button>

    <div class="menu-category">üìê Z√°kladn√© jednotky</div>
    <button class="menu-btn" onclick="openConverter('dlzka')"><span>üìè</span> Dƒ∫≈æka</button>
    <button class="menu-btn" onclick="openConverter('hmotnost')"><span>‚öñÔ∏è</span> Hmotnos≈•</button>
    <button class="menu-btn" onclick="openConverter('teplota')"><span>üå°Ô∏è</span> Teplota</button>
    <button class="menu-btn" onclick="openConverter('cas')"><span>‚è∞</span> ƒåas</button>
    <button class="menu-btn" onclick="openConverter('rychlost')"><span>üöÄ</span> R√Ωchlos≈•</button>
    <button class="menu-btn" onclick="openConverter('objem')"><span>ü•õ</span> Objem</button>
    <button class="menu-btn" onclick="openConverter('plocha')"><span>üß±</span> Plocha</button>

    <div class="menu-category">‚ö° Fyzik√°lne jednotky</div>
    <button class="menu-btn" onclick="openConverter('energia')"><span>‚ö°</span> Energia</button>
    <button class="menu-btn" onclick="openConverter('vykon')"><span>üí°</span> V√Ωkon</button>
    <button class="menu-btn" onclick="openConverter('tlak')"><span>üå¨Ô∏è</span> Tlak</button>
    <button class="menu-btn" onclick="openConverter('sila')"><span>üí™</span> Sila</button>
    <button class="menu-btn" onclick="openConverter('frekvencia')"><span>üìª</span> Frekvencia</button>
    <button class="menu-btn" onclick="openConverter('elektrina')"><span>üîå</span> Elektrick√Ω pr√∫d</button>

    <div class="menu-category">üíæ Digit√°lne jednotky</div>
    <button class="menu-btn" onclick="openConverter('data')"><span>üíæ</span> D√°tov√Ω objem</button>
    <button class="menu-btn" onclick="openConverter('prenos')"><span>üì∂</span> Prenosov√° r√Ωchlos≈•</button>

    <div class="menu-category">üç≥ Kuchynsk√© jednotky</div>
    <button class="menu-btn" onclick="openConverter('kuchyna')"><span>üç≥</span> Kuchynsk√© miery</button>

    <div class="menu-category">üåç Geografick√© jednotky</div>
    <button class="menu-btn" onclick="openConverter('uhol')"><span>üìê</span> Uhol</button>
    <button class="menu-btn" onclick="openConverter('hustota')"><span>üßä</span> Hustota</button>

    <div class="menu-category">‚öôÔ∏è Nastavenia</div>
    <button class="menu-btn" onclick="openSection('settings')"><span>‚öôÔ∏è</span> Nastavenia</button>
  </div>

  <!-- Kalkulaƒçka -->
  <div id="calc" class="section" aria-label="Kalkulaƒçka">
    <div class="back-bar">
      <a class="back-btn" onclick="backToMenu()">‚Üê Sp√§≈•</a>
      <h3 class="section-title">Kalkulaƒçka</h3>
    </div>
    <div class="calculator">
      <input type="text" id="display" class="calc-display" readonly placeholder="0" aria-label="V√Ωsledok kalkulaƒçky">
      <div class="calc-grid" role="group" aria-label="Tlaƒçidl√° kalkulaƒçky">
        <button aria-label="7" onclick="addCalc('7')">7</button>
        <button aria-label="8" onclick="addCalc('8')">8</button>
        <button aria-label="9" onclick="addCalc('9')">9</button>
        <button aria-label="Delenie" onclick="addCalc('/')">√∑</button>

        <button aria-label="4" onclick="addCalc('4')">4</button>
        <button aria-label="5" onclick="addCalc('5')">5</button>
        <button aria-label="6" onclick="addCalc('6')">6</button>
        <button aria-label="N√°sobenie" onclick="addCalc('*')">√ó</button>

        <button aria-label="1" onclick="addCalc('1')">1</button>
        <button aria-label="2" onclick="addCalc('2')">2</button>
        <button aria-label="3" onclick="addCalc('3')">3</button>
        <button aria-label="M√≠nus" onclick="addCalc('-')">‚àí</button>

        <button aria-label="0" onclick="addCalc('0')">0</button>
        <button aria-label="Desatinn√° bodka" onclick="addCalc('.')">.</button>
        <button class="accent" aria-label="Rovno sa" onclick="calculate()">=</button>
        <button aria-label="Plus" onclick="addCalc('+')">+</button>

        <button class="accent" aria-label="Vymaza≈•" onclick="clearDisplay()" style="grid-column: span 2;">AC</button>
        <button aria-label="Zmaza≈• posledn√Ω znak" onclick="backspace()" style="grid-column: span 2;">‚å´</button>
      </div>
    </div>
  </div>

  <!-- Konvertor -->
  <div id="converter" class="section" aria-label="Konvertor">
    <div class="back-bar">
      <a class="back-btn" onclick="backToMenu()">‚Üê Sp√§≈•</a>
      <h3 id="convTitle" class="section-title"></h3>
    </div>
    <div class="converter" role="form" aria-label="Formul√°r konvertora">
      <label for="convValue">Hodnota</label>
      <input type="number" id="convValue" placeholder="Zadajte hodnotu" inputmode="decimal" step="any" oninput="autoConvert()">
      <span class="small">Automatick√Ω prevod pri p√≠san√≠</span>

      <label for="fromUnit">Z jednotky</label>
      <select id="fromUnit" aria-label="Z jednotky" onchange="autoConvert()"></select>

      <label for="toUnit">Na jednotku</label>
      <select id="toUnit" aria-label="Na jednotku" onchange="autoConvert()"></select>

      <button onclick="convertUnits()">üîÑ Prepoƒç√≠ta≈•</button>
      <div class="result" id="convResult" aria-live="polite">Zadajte hodnotu</div>
    </div>
  </div>

  <!-- Nastavenia -->
  <div id="settings" class="section settings" aria-label="Nastavenia">
    <div class="back-bar">
      <a class="back-btn" onclick="backToMenu()">‚Üê Sp√§≈•</a>
      <h3 class="section-title">Nastavenia</h3>
    </div>

    <div class="card">
      <label>
        <input type="checkbox" id="darkMode" checked onchange="toggleTheme()">
        Tmav√Ω re≈æim
      </label>
      <div class="small">Prepne medzi tmav√Ωm a svetl√Ωm re≈æimom</div>
    </div>

    <div class="card">
      <div style="font-weight: 600; font-size: 1.05rem;">üé® Farebn√° t√©ma</div>
      <div class="theme-selector">
        <div class="theme-option theme-blue active" onclick="setColorTheme('blue')">Modr√°</div>
        <div class="theme-option theme-purple" onclick="setColorTheme('purple')">Fialov√°</div>
        <div class="theme-option theme-green" onclick="setColorTheme('green')">Zelen√°</div>
        <div class="theme-option theme-orange" onclick="setColorTheme('orange')">Oran≈æov√°</div>
      </div>
    </div>

    <div class="card">
      <div>
        <label for="precision">
          üî¢ Presnos≈• (desatinn√© miesta): <span id="precisionValue">4</span>
        </label>
      </div>
      <input type="range" id="precision" min="2" max="12" value="4" oninput="updatePrecision(this.value)" style="width: 100%; accent-color: var(--accent);">
      <div class="small">Poƒçet desatinn√Ωch miest pri prevode</div>
    </div>

    <div class="card">
      <div>
        <label for="numberFormat">üåç Form√°t ƒç√≠siel</label>
      </div>
      <select id="numberFormat" onchange="updateNumberFormat()">
        <option value="sk">Eur√≥psky (1 234,56)</option>
        <option value="en">Anglo-americk√Ω (1,234.56)</option>
      </select>
      <div class="small">Form√°t zobrazenia ƒç√≠siel</div>
    </div>

    <div class="card">
      <button class="btn" onclick="clearHistory()">üóëÔ∏è Vymaza≈• ulo≈æen√© √∫daje</button>
      <div class="small">Vyma≈æe v≈°etky nastavenia a hist√≥riu prevodov</div>
    </div>
  </div>
</div>

<script>
// --- Glob√°lne nastavenia ---
let settings = {
  darkMode: true,
  colorTheme: 'blue',
  precision: 4,
  numberFormat: 'sk'
};

// --- Prep√≠nanie sekci√≠ ---
function openSection(id){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById('menu').style.display='none';
  document.getElementById(id).classList.add('active');
  
  // Naƒç√≠ta≈• UI nastavenia iba ak sa otv√°ra sekcia nastaven√≠
  if(id === 'settings') {
    document.getElementById('darkMode').checked = settings.darkMode;
    document.getElementById('precision').value = settings.precision;
    document.getElementById('precisionValue').textContent = settings.precision;
    document.getElementById('numberFormat').value = settings.numberFormat;
    
    // Nastavi≈• akt√≠vnu farebn√∫ t√©mu
    document.querySelectorAll('.theme-option').forEach(opt => {
      opt.classList.remove('active');
    });
    document.querySelector(`.theme-${settings.colorTheme}`).classList.add('active');
  }
}

function backToMenu(){
  document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
  document.getElementById('menu').style.display='flex';
}

// --- Kalkulaƒçka ---
const display = document.getElementById("display");

function addCalc(v){ 
  display.value += v; 
}

function clearDisplay(){ 
  display.value = ""; 
}

function backspace(){
  display.value = display.value.slice(0, -1);
}

function calculate(){
  try{
    const expr = display.value.replace(/,/g,'.').replace(/√ó/g,'*').replace(/√∑/g,'/').replace(/‚àí/g,'-');
    const result = Function('"use strict"; return (' + expr + ')')();
    display.value = formatNumber(result);
  }catch{
    display.value = "Chyba";
    setTimeout(() => clearDisplay(), 1500);
  }
}

// --- Konvertory ---
const converters = {
  dlzka: {
    m: 1, km: 1000, cm: 0.01, mm: 0.001, Œºm: 1e-6, nm: 1e-9,
    mi: 1609.344, yd: 0.9144, ft: 0.3048, in: 0.0254,
    "naut mi": 1852, "light year": 9.461e15, AU: 1.496e11
  },
  hmotnost: {
    kg: 1, g: 0.001, mg: 1e-6, Œºg: 1e-9, t: 1000, kt: 1e6,
    lb: 0.45359237, oz: 0.028349523125, stone: 6.35029318, ton: 907.18474
  },
  teplota: {
    convert: (v,from,to)=>{
      let c;
      if(from === "¬∞C") c = v;
      else if(from === "¬∞F") c = (v-32)*5/9;
      else if(from === "K") c = v - 273.15;
      else if(from === "¬∞R") c = (v - 491.67) * 5/9;
      if(to === "¬∞C") return c;
      if(to === "¬∞F") return c*9/5+32;
      if(to === "K") return c+273.15;
      if(to === "¬∞R") return (c + 273.15) * 9/5;
      return v;
    },
    units: ["¬∞C","¬∞F","K","¬∞R"]
  },
  cas: {
    ns: 1e-9, Œºs: 1e-6, ms: 0.001, s: 1, min: 60, h: 3600, 
    day: 86400, week: 604800, month: 2628000, year: 31557600, decade: 315576000
  },
  rychlost: {
    "m/s": 1, "km/h": 0.2777777778, "mph": 0.44704, "ft/s": 0.3048,
    "knot": 0.5144444444, "Mach": 343
  },
  objem: {
    l: 1, ml: 0.001, cl: 0.01, dl: 0.1, cm3: 0.001, m3: 1000,
    gal: 3.785411784, "gal (UK)": 4.54609, qt: 0.946352946, pint: 0.473176473, 
    cup: 0.24, "fl oz": 0.0295735295625, "fl oz (UK)": 0.0284130625, tbsp: 0.01478676478125,
    tsp: 0.00492892159375, bbl: 158.987294928
  },
  plocha: {
    "m¬≤": 1, "cm¬≤": 0.0001, "mm¬≤": 1e-6, "km¬≤": 1e6, ha: 10000, a: 100,
    "ft¬≤": 0.09290304, "in¬≤": 0.00064516, "yd¬≤": 0.83612736, acre: 4046.8564224, "mi¬≤": 2589988.110336
  },
  energia: {
    J: 1, kJ: 1000, MJ: 1e6, GJ: 1e9,
    cal: 4.184, kcal: 4184, Wh: 3600, kWh: 3.6e6, MWh: 3.6e9,
    eV: 1.602176634e-19, BTU: 1055.05585262, "ft¬∑lbf": 1.3558179483314004
  },
  vykon: {
    W: 1, kW: 1000, MW: 1e6, GW: 1e9,
    HP: 745.6998715822702, "HP (UK)": 745.69987158227, "BTU/h": 0.29307107017
  },
  tlak: {
    Pa: 1, kPa: 1000, MPa: 1e6, GPa: 1e9,
    bar: 100000, mbar: 100, atm: 101325, 
    psi: 6894.757293168, torr: 133.322387415, mmHg: 133.322387415
  },
  sila: {
    N: 1, kN: 1000, MN: 1e6,
    dyn: 1e-5, lbf: 4.4482216152605, kgf: 9.80665, ozf: 0.27801385095378125
  },
  frekvencia: {
    Hz: 1, kHz: 1000, MHz: 1e6, GHz: 1e9, THz: 1e12,
    rpm: 1/60, "rad/s": 1/(2*Math.PI)
  },
  elektrina: {
    A: 1, mA: 0.001, ŒºA: 1e-6, kA: 1000,
    V: 1, mV: 0.001, kV: 1000, MV: 1e6,
    Œ©: 1, mŒ©: 0.001, kŒ©: 1000, MŒ©: 1e6,
    W: 1, mW: 0.001, kW: 1000
  },
  data: {
    B: 1, KB: 1024, MB: 1048576, GB: 1073741824, TB: 1099511627776, PB: 1125899906842624,
    bit: 0.125, Kb: 128, Mb: 131072, Gb: 134217728, Tb: 137438953472
  },
  prenos: {
    "b/s": 0.125, "Kb/s": 128, "Mb/s": 131072, "Gb/s": 134217728,
    "B/s": 1, "KB/s": 1024, "MB/s": 1048576, "GB/s": 1073741824
  },
  kuchyna: {
    ml: 1, l: 1000, dl: 100, cl: 10,
    "≈°√°lka": 240, "polievkov√° ly≈æica": 15, "ƒçajov√° ly≈æiƒçka": 5,
    "polievkov√° ly≈æica (UK)": 17.7582, "ƒçajov√° ly≈æiƒçka (UK)": 5.9194,
    "cup (US)": 236.588, "tbsp (US)": 14.7868, "tsp (US)": 4.92892,
    "fl oz (US)": 29.5735, "pint (US)": 473.176, "qt (US)": 946.353,
    "gal (US)": 3785.41
  },
  uhol: {
    "¬∞": 1, rad: 57.2957795131, grad: 0.9, 
    arcmin: 1/60, arcsec: 1/3600, turn: 360, mrad: 0.0572957795131
  },
  hustota: {
    "kg/m¬≥": 1, "g/cm¬≥": 1000, "kg/l": 1000, "g/ml": 1000,
    "lb/ft¬≥": 16.0184633739601, "lb/in¬≥": 27679.9047102031, "oz/gal": 7.4891517645772
  }
};

const unitIcons = {
  dlzka: { 
    m:"üìè", km:"üó∫Ô∏è", cm:"üìè", mm:"üìè", Œºm:"üî¨", nm:"üî¨",
    mi:"üõ£Ô∏è", yd:"üìê", ft:"üìê", in:"üìê", "naut mi":"‚õµ", 
    "light year":"üåå", AU:"ü™ê"
  },
  hmotnost: { 
    kg:"‚öñÔ∏è", g:"‚öñÔ∏è", mg:"‚öñÔ∏è", Œºg:"üî¨", t:"üöö", kt:"üèîÔ∏è",
    lb:"üèãÔ∏è", oz:"ü•Ñ", stone:"üóø", ton:"üöõ"
  },
  teplota: { "¬∞C":"üå°Ô∏è", "¬∞F":"üå°Ô∏è", "K":"üß™", "¬∞R":"üß™" },
  cas: { 
    ns:"‚ö°", Œºs:"‚ö°", ms:"‚è±Ô∏è", s:"‚è±Ô∏è", min:"‚è∞", h:"‚è∞", 
    day:"üìÖ", week:"üìÖ", month:"üìÖ", year:"üìÖ", decade:"üìö"
  },
  rychlost: { 
    "m/s":"üöÄ", "km/h":"üöó", "mph":"üöó", "ft/s":"üèÉ", 
    "knot":"‚õµ", "Mach":"‚úàÔ∏è"
  },
  objem: { 
    l:"ü•õ", ml:"ü•õ", cl:"ü•õ", dl:"ü•õ", cm3:"üß™", m3:"üì¶",
    gal:"ü´ó", "gal (UK)":"ü´ó", qt:"ü´ó", pint:"üç∫", cup:"‚òï",
    "fl oz":"ü•§", "fl oz (UK)":"ü•§", tbsp:"ü•Ñ", tsp:"ü•Ñ", bbl:"üõ¢Ô∏è"
  },
  plocha: { 
    "m¬≤":"üß±", "cm¬≤":"üß±", "mm¬≤":"üî¨", "km¬≤":"üó∫Ô∏è", ha:"üåæ", a:"üåæ",
    "ft¬≤":"üè†", "in¬≤":"üìê", "yd¬≤":"üè°", acre:"üöú", "mi¬≤":"üó∫Ô∏è"
  },
  energia: { 
    J:"‚ö°", kJ:"‚ö°", MJ:"‚ö°", GJ:"‚ö°",
    cal:"üî•", kcal:"üî•", Wh:"üîå", kWh:"üîå", MWh:"üîå",
    eV:"‚öõÔ∏è", BTU:"üî•", "ft¬∑lbf":"üí™"
  },
  vykon: { 
    W:"üí°", kW:"üí°", MW:"üí°", GW:"üí°",
    HP:"üê¥", "HP (UK)":"üê¥", "BTU/h":"üî•"
  },
  tlak: { 
    Pa:"üå¨Ô∏è", kPa:"üå¨Ô∏è", MPa:"üå¨Ô∏è", GPa:"üå¨Ô∏è",
    bar:"üå¨Ô∏è", mbar:"üå¨Ô∏è", atm:"üåç", 
    psi:"üîß", torr:"üß™", mmHg:"ü©∫"
  },
  sila: {
    N:"üí™", kN:"üí™", MN:"üí™",
    dyn:"üí™", lbf:"üèãÔ∏è", kgf:"‚öñÔ∏è", ozf:"ü•Ñ"
  },
  frekvencia: {
    Hz:"üìª", kHz:"üìª", MHz:"üìª", GHz:"üìª", THz:"üìª",
    rpm:"‚öôÔ∏è", "rad/s":"‚öôÔ∏è"
  },
  elektrina: {
    A:"üîå", mA:"üîå", ŒºA:"üîå", kA:"üîå",
    V:"‚ö°", mV:"‚ö°", kV:"‚ö°", MV:"‚ö°",
    Œ©:"üîå", mŒ©:"üîå", kŒ©:"üîå", MŒ©:"üîå",
    W:"üí°", mW:"üí°", kW:"üí°"
  },
  data: {
    B:"üíæ", KB:"üíæ", MB:"üíæ", GB:"üíæ", TB:"üíæ", PB:"üíæ",
    bit:"üíæ", Kb:"üíæ", Mb:"üíæ", Gb:"üíæ", Tb:"üíæ"
  },
  prenos: {
    "b/s":"üì∂", "Kb/s":"üì∂", "Mb/s":"üì∂", "Gb/s":"üì∂",
    "B/s":"üì∂", "KB/s":"üì∂", "MB/s":"üì∂", "GB/s":"üì∂"
  },
  kuchyna: {
    ml:"ü•õ", l:"ü•õ", dl:"ü•õ", cl:"ü•õ",
    "≈°√°lka":"‚òï", "polievkov√° ly≈æica":"ü•Ñ", "ƒçajov√° ly≈æiƒçka":"ü•Ñ",
    "polievkov√° ly≈æica (UK)":"ü•Ñ", "ƒçajov√° ly≈æiƒçka (UK)":"ü•Ñ",
    "cup (US)":"‚òï", "tbsp (US)":"ü•Ñ", "tsp (US)":"ü•Ñ",
    "fl oz (US)":"ü•§", "pint (US)":"üç∫", "qt (US)":"ü´ó",
    "gal (US)":"ü´ó"
  },
  uhol: {
    "¬∞":"üìê", rad:"üîÑ", grad:"üìê", 
    arcmin:"üìê", arcsec:"üìê", turn:"üîÑ", mrad:"üéØ"
  },
  hustota: {
    "kg/m¬≥":"üßä", "g/cm¬≥":"üßä", "kg/l":"üßä", "g/ml":"üßä",
    "lb/ft¬≥":"üßä", "lb/in¬≥":"üßä", "oz/gal":"üßä"
  }
};

let currentConv = "";
const convTitle = document.getElementById("convTitle");
const fromSel = document.getElementById("fromUnit");
const toSel = document.getElementById("toUnit");
const convValueEl = document.getElementById("convValue");
const convResult = document.getElementById("convResult");

function openConverter(type){
  openSection('converter');
  currentConv = type;
  
  const titles = {
    dlzka: "Dƒ∫≈æka", hmotnost: "Hmotnos≈•", teplota: "Teplota", 
    cas: "ƒåas", rychlost: "R√Ωchlos≈•", objem: "Objem", plocha: "Plocha",
    energia: "Energia", vykon: "V√Ωkon", tlak: "Tlak", sila: "Sila",
    frekvencia: "Frekvencia", elektrina: "Elektrick√Ω pr√∫d", 
    data: "D√°tov√Ω objem", prenos: "Prenosov√° r√Ωchlos≈•",
    kuchyna: "Kuchynsk√© miery", uhol: "Uhol", hustota: "Hustota"
  };
  
  convTitle.textContent = titles[type] || type;

  fromSel.innerHTML = "";
  toSel.innerHTML = "";

  const conv = converters[type];
  if(conv.units){
    conv.units.forEach(u=>{
      const icon = unitIcons[type]?.[u] ?? "";
      fromSel.innerHTML += `<option value="${u}">${icon} ${u}</option>`;
      toSel.innerHTML += `<option value="${u}">${icon} ${u}</option>`;
    });
  } else {
    for(const u in conv){
      const icon = unitIcons[type]?.[u] ?? "";
      fromSel.innerHTML += `<option value="${u}">${icon} ${u}</option>`;
      toSel.innerHTML += `<option value="${u}">${icon} ${u}</option>`;
    }
  }

  // Naƒç√≠ta≈• ulo≈æen√Ω prevod
  const saved = JSON.parse(localStorage.getItem("lastConversion") || "{}");
  if(saved.type === type){
    convValueEl.value = saved.value ?? "";
    if(saved.from && [...fromSel.options].some(o=>o.value===saved.from)) fromSel.value = saved.from;
    if(saved.to && [...toSel.options].some(o=>o.value===saved.to)) toSel.value = saved.to;
    if(saved.value) autoConvert();
  } else {
    convValueEl.value = "";
    convResult.textContent = "Zadajte hodnotu";
  }
}

function formatNumber(num) {
  if(num === null || num === undefined || isNaN(num)) return "";
  const locale = settings.numberFormat === 'sk' ? 'sk-SK' : 'en-US';
  return new Intl.NumberFormat(locale, { 
    maximumFractionDigits: settings.precision,
    minimumFractionDigits: 0
  }).format(num);
}

function convertUnits(){
  const raw = (convValueEl.value || "").toString().trim();
  if(!raw){ 
    convResult.textContent = "Zadajte ƒç√≠slo"; 
    return; 
  }
  
  const value = parseFloat(raw.replace(',','.'));
  if(Number.isNaN(value)){ 
    convResult.textContent = "‚ùå Neplatn√° hodnota"; 
    return; 
  }

  const from = fromSel.value;
  const to = toSel.value;

  let result;
  if(converters[currentConv].convert){
    result = converters[currentConv].convert(value, from, to);
  } else {
    const base = value * converters[currentConv][from];
    result = base / converters[currentConv][to];
  }

  const fromIcon = unitIcons[currentConv]?.[from] ?? "";
  const toIcon = unitIcons[currentConv]?.[to] ?? "";
  
  convResult.innerHTML = `
    <div style="font-size: 0.95rem; color: var(--text-secondary); margin-bottom: 4px;">
      ${fromIcon} ${formatNumber(value)} ${from}
    </div>
    <div style="font-size: 1.4rem; font-weight: 800;">
      ${toIcon} ${formatNumber(result)} ${to}
    </div>
  `;

  // Ulo≈æi≈• prevod
  localStorage.setItem("lastConversion", JSON.stringify({
    type: currentConv, value, from, to
  }));
}

function autoConvert(){
  if(convValueEl.value) {
    convertUnits();
  }
}

// --- Nastavenia ---
function toggleTheme(){
  settings.darkMode = document.getElementById('darkMode').checked;
  applyTheme();
  saveSettings();
}

function setColorTheme(theme){
  settings.colorTheme = theme;
  document.querySelectorAll('.theme-option').forEach(opt => {
    opt.classList.remove('active');
  });
  document.querySelector(`.theme-${theme}`).classList.add('active');
  applyTheme();
  saveSettings();
}

function applyTheme(){
  const body = document.body;
  
  // Odstr√°ni≈• v≈°etky t√©my
  body.classList.remove('theme-light', 'theme-purple', 'theme-green', 'theme-orange');
  
  // Aplikova≈• svetl√Ω/tmav√Ω re≈æim
  if(!settings.darkMode) {
    body.classList.add('theme-light');
  }
  
  // Aplikova≈• farebn√∫ t√©mu
  if(settings.colorTheme !== 'blue') {
    body.classList.add(`theme-${settings.colorTheme}`);
  }
}

function updatePrecision(value){
  settings.precision = parseInt(value);
  document.getElementById('precisionValue').textContent = value;
  saveSettings();
  if(convValueEl.value) autoConvert();
}

function updateNumberFormat(){
  settings.numberFormat = document.getElementById('numberFormat').value;
  saveSettings();
  if(convValueEl.value) autoConvert();
}

function saveSettings(){
  localStorage.setItem('appSettings', JSON.stringify(settings));
}

function loadSettings(){
  const saved = localStorage.getItem('appSettings');
  if(saved) {
    settings = {...settings, ...JSON.parse(saved)};
  }
  applyTheme();
}

function clearHistory(){
  if(confirm('Naozaj chcete vymaza≈• v≈°etky ulo≈æen√© √∫daje?')) {
    localStorage.removeItem('lastConversion');
    localStorage.removeItem('appSettings');
    settings = {
      darkMode: true,
      colorTheme: 'blue',
      precision: 4,
      numberFormat: 'sk'
    };
    
    // Aktualizova≈• UI nastaven√≠ (preto≈æe sme v nastaveniach)
    document.getElementById('darkMode').checked = settings.darkMode;
    document.getElementById('precision').value = settings.precision;
    document.getElementById('precisionValue').textContent = settings.precision;
    document.getElementById('numberFormat').value = settings.numberFormat;
    document.querySelectorAll('.theme-option').forEach(opt => {
      opt.classList.remove('active');
    });
    document.querySelector('.theme-blue').classList.add('active');
    
    applyTheme();
    convResult.textContent = "Zadajte hodnotu";
    convValueEl.value = "";
    display.value = "";
    alert('‚úÖ V≈°etky √∫daje boli vymazan√©!');
  }
}

// --- Inicializ√°cia ---
window.addEventListener('DOMContentLoaded', () => {
  const saved = localStorage.getItem('appSettings');
  if(saved) {
    settings = {...settings, ...JSON.parse(saved)};
  }
  applyTheme();
  backToMenu();
});

// Kl√°vesov√© skratky pre kalkulaƒçku
document.addEventListener('keydown', (e) => {
  if(document.getElementById('calc').classList.contains('active')) {
    if(e.key >= '0' && e.key <= '9') addCalc(e.key);
    else if(e.key === '+' || e.key === '-' || e.key === '*' || e.key === '/') addCalc(e.key);
    else if(e.key === '.' || e.key === ',') addCalc('.');
    else if(e.key === 'Enter') calculate();
    else if(e.key === 'Escape') clearDisplay();
    else if(e.key === 'Backspace' && e.target !== display) backspace();
  }
});
</script>
</body>
</html>